# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# Filename: package/.../iptables/iptables.conf
# Copyright (C) 2007 The OpenSDE Project
# Copyright (C) 2004 - 2006 The T2 SDE Project
# Copyright (C) 1998 - 2003 Clifford Wolf
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

for x in $( match_source_file -p patch ); do
	var_append patchfiles ' ' "$x"
done

# never ever use the kernel source - always use the installed headers
var_append makeopt ' ' "PREFIX=$root/$prefix"
var_append makeopt ' ' "BINDIR=$root/sbin" 
var_append makeopt ' ' "KERNEL_DIR=$root/usr"

[ "$SDECFG_STATIC" == 1 ] && var_append makeopt ' ' "DO_MULTI=1 NO_SHARED_LIBS=1"

makeinstopt="$makeopt install"

iptables_install_devel() {
	$MAKE $makeopt install-devel

	cp -vf iptables.o "$root$libdir"
	cp -vf include/{iptables,iptables_common}.h "$root$includedir/"

	mkdir -vp "$root$includedir/libiptc"
	cp -vf include/libiptc/{libiptc,ipt_kernel_headers}.h "$root$includedir/libiptc/"
}

[ "$SDECFG_PKG_IPTABLES_DEVEL" != 0 ] && hook_add postmake 5 'iptables_install_devel'

runconf=0
