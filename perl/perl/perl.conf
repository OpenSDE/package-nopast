# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../perl/perl.conf
# Copyright (C) 2012 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

untar_cross_perl() {
	tar -v $taropt $( match_source_file -p cross perl ) -C $builddir/
}
hook_add prepatch 1 "untar_cross_perl"

# configure is not standard 
cleanconfopt=0

confopt="--prefix=/$prefix \$extraconfopt"
extraconfopt=

makeinstopt="install"

if ! atstage native; then
	var_append extraconfopt ' ' "--build=$arch_build"
	var_append extraconfopt ' ' "--target=$arch_target" 
	var_insert makeinstopt ' ' "DESTDIR=$root"
fi

# let -D and -U override definitions from loaded configuration file
var_append extraconfopt ' ' "-O"

# build a shared libperl
if [ "$SDECFG_STATIC" != 1 ]; then
	var_append extraconfopt ' ' "-Duseshrplib"
fi

# thread support
if [ "$SDECFG_PKG_PERL5_THREADS" = "1" ]; then
	var_append extraconfopt ' ' "-Dusethreads"
fi
