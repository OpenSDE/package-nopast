# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# Filename: package/.../lualdap/config-no-compat-5.1.patch
# Copyright (C) 2006 The OpenSDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- SDE-COPYRIGHT-NOTE-END ---

--- ./Makefile.orig	2006-10-09 14:22:17.000000000 +0200
+++ ./Makefile	2006-10-09 14:22:40.000000000 +0200
@@ -6,15 +6,12 @@
 
 include $(CONFIG)
 
-OBJS= src/lualdap.o $(COMPAT_DIR)/compat-5.1.o
+OBJS= src/lualdap.o
 
 
 src/$(LIBNAME): $(OBJS)
 	export MACOSX_DEPLOYMENT_TARGET="10.3"; $(CC) $(CFLAGS) $(LIB_OPTION) -o src/$(LIBNAME) $(OBJS) $(OPENLDAP_LIB)
 
-$(COMPAT_DIR)/compat-5.1.o: $(COMPAT_DIR)/compat-5.1.c
-	$(CC) -c $(CFLAGS) -o $@ $(COMPAT_DIR)/compat-5.1.c
-
 install: src/$(LIBNAME)
 	mkdir -p $(LUA_LIBDIR)
 	cp src/$(LIBNAME) $(LUA_LIBDIR)
--- ./config.orig	2006-10-09 14:29:38.000000000 +0200
+++ ./config	2006-10-09 14:29:06.000000000 +0200
@@ -1,8 +1,8 @@
 # Installation directories
 # System's libraries directory (where binary libraries are installed)
-LUA_LIBDIR= /usr/local/lib/lua/5.0
+LUA_LIBDIR= $(shell pkg-config --variable INSTALL_CMOD lua)
 # Lua includes directory
-LUA_INC= /usr/local/include
+LUA_INC= $(shell pkg-config --variable INSTALL_LMOD lua)
 # OpenLDAP includes directory
 OPENLDAP_INC= /usr/local/include
 # OpenLDAP library (an optional directory can be specified with -L<dir>)
@@ -13,11 +13,10 @@
 #LIB_OPTION= -bundle -undefined dynamic_lookup #for MacOS X
 
 LIBNAME= $T.so.$V
-COMPAT_DIR= ../compat/src
 
 # Compilation parameters
 WARN= -O2 -Wall -fPIC -W -Waggregate-return -Wcast-align -Wmissing-prototypes -Wnested-externs -Wshadow -Wwrite-strings -ansi
-INCS= -I$(LUA_INC) -I$(OPENLDAP_INC) -I$(COMPAT_DIR)
+INCS= -I$(LUA_INC) -I$(OPENLDAP_INC)
 CFLAGS= $(WARN) $(INCS)
 CC= gcc
 
--- ./src/lualdap.c.orig	2006-10-09 14:35:48.000000000 +0200
+++ ./src/lualdap.c	2006-10-09 14:35:11.000000000 +0200
@@ -16,7 +16,6 @@
 
 #include "lua.h"
 #include "lauxlib.h"
-#include "compat-5.1.h"
 
 
 #define LUALDAP_PREFIX "LuaLDAP: "
