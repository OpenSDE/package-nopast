# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../fftw3/fftw3.conf
# Copyright (C) 2011 The OpenSDE Project
# Copyright (C) 2004 - 2006 The T2 SDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

# shared library support has to be enabled explicitely
[ "$SDECFG_STATIC" != 1 ] && var_append extraconfopt " " "--enable-shared"

# Optimization
[ "$arch" = "x86" ] && var_append confopt " " "--enable-i386-hacks"

var_append confopt " " "--enable-threads"

if [ ! "`type -p f77`" ] ; then
    var_append confopt ' ' "--disable-fortran"
fi

# There are 3 APIs available which have to be build seperately
# 1. double precision (default)
# 2. single precision (--enable-single or --enable-float)
# 3. long-double precision (--enable-long-double)
buildloops=3

pkg_fftw3_preconf() {
	if [ $buildloop -eq 2 ]; then
		var_append extraconfopt " " "--enable-float"
	elif [ $buildloop -eq 3 ]; then
		var_remove extraconfopt " " "--enable-float"
		var_append extraconfopt " " "--enable-long-double"
	fi
}
hook_add preconf 5 'pkg_fftw3_preconf'
