# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../dovecot/dovecot.conf
# Copyright (C) 2007 - 2013 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

# install development headers by default
var_append confopt ' ' "--enable-header-install"

# package/option mappings for auto-configuration
pkg_dovecot_options="openldap:ldap=plugin postgresql:pgsql mysql sqlite"

# automatic feature selection according to the package/option mappings
pkg_dovecot_autoconfig() {
	local args="$@"
	for x in $args; do
		local package="${x%:*}"
		local option="${x#*:}"
		[ ! -z "$option" ] || option="$package"
		if pkginstalled -f "$package"; then
			pkgprefix -t "$package"
			var_append extraconfopt ' ' "--with-$option"
			case $package in
				*sql*) enable_sql=true ;;
			esac
		fi
	done
	# generic SQL support/build drivers as plugins
	if $enable_sql; then
		var_append extraconfopt ' ' "--with-sql=plugin"
	fi
}
pkg_dovecot_autoconfig "$pkg_dovecot_options"
