# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../dspam/dspam.conf
# Copyright (C) 2013 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---


if [ $prefix_auto = 1 ]; then
        # use a dedicated sysconfdir
        sysconfdir="$sysconfdir/$pkg"
fi


storage="hash_drv"

# enable what we need without dependency
var_append confopt ' ' "--enable-daemon" 
var_append confopt ' ' "--enable-clamav" 
var_append confopt ' ' "--enable-debug"
var_append confopt ' ' "--enable-bnr-debug"
var_append confopt ' ' "--enable-verbose-debug"
var_append confopt ' ' "--enable-external-lookup"
var_append confopt ' ' "--enable-static=no"
var_append confopt ' ' "--enable-split-configuration"
var_append confopt ' ' "--enable-domain-scale"
var_append confopt ' ' "--enable-long-usernames"
var_append confopt ' ' "--with-dspam-home=$localstatedir/dspam"
var_append confopt ' ' "--with-dspam-home-owner=dspam"
var_append confopt ' ' "--with-dspam-home-group=dspam"
var_append confopt ' ' "--with-dspam-owner=dspam"
var_append confopt ' ' "--with-dspam-group=dspam"

for x in postgresql:pgsql mysql:mysql; do
	if pkginstalled "${x%:*}"; then
		pkgprefix -t "${x%:*}"
		var_append confopt ' ' "--with-${x#*:}-includes=$root$( pkgprefix includedir ${x%:*} )"
		var_append confopt ' ' "--with-${x#*:}-libraries=$root$( pkgprefix libdir ${x%:*} )"
		storage="${storage},${x#*:}_drv"
		var_append confopt ' ' "--enable-preferences-extension"
		var_append confopt ' ' "--enable-virtual-users"
        fi
done

if pkginstalled sqlite; then
        pkgprefix -t sqlite
        var_append confopt ' ' "--with-sqlite-includes=$root$( pkgprefix includedir sqlite )"
        var_append confopt ' ' "--with-sqlite-libraries=$root$( pkgprefix libdir sqlite )"
        storage="${storage},sqlite3_drv"
fi

var_append confopt ' ' "--with-storage-driver=${storage}"

