# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../protobuf/protobuf.conf
# Copyright (C) 2013 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

autogen=1

# protobuf includes a copy of gtest which itself provides a configure
# script that is called right after the one from the toplevel directory.
# When providing a config.cache file this second configure call fails,
# telling that CFLAGS and CXXFLAGS haven't been set in the config cache.
# Initializing them in the environment solves the issue.
var_append configprefix ' ' "CFLAGS= CXXFLAGS="

if atstage cross; then
	# use the natively build protoc we installed at stage 0
	var_append extraconfopt ' ' "--with-protoc=$arch_target-protoc"
fi
