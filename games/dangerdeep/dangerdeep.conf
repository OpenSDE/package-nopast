# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../dangerdeep/dangerdeep.conf
# Copyright (C) 2007 - 2011 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

dftd_custmain() {
	# Replace hardcoded paths with configured ones.
	sed -i -e 's,/usr/X11R6/lib,'$(pkgprefix libdir xorg-server)',g' \
	-e 's,/usr/include/GL,'$(pkgprefix includedir xorg-server)'/GL,g' \
	-e 's,/usr/lib,'$(pkgprefix libdir fftw3)',g' SConstruct

	# Start building and tell the builder where the app should
	# be installed.
	var_append sconsopt ' ' "installbindir=$root/$prefix/games \
	datadir=$root/$datadir/games/$pkg version=$ver"
	scons devel=1 $sconsopt

	# Make sure to install datafiles as well.
	cp -rf build/linux/dangerdeep $root/$prefix/games/
	unzip `match_source_file -p *.zip` && cp -rf data \
	$root/$datadir/games/$pkg
}

# Scons builds are not yet properly supported so we have to do it
# all ourselves.
custmain="dftd_custmain"
