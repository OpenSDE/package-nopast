# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../readline/install-no_rm.patch
# Copyright (C) 2006 - 2010 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
# --- SDE-COPYRIGHT-NOTE-END ---

diff -ruN readline-6.1-orig/Makefile.in readline-6.1/Makefile.in
--- readline-6.1-orig/Makefile.in	2009-04-19 18:14:24.000000000 +0200
+++ readline-6.1/Makefile.in	2010-09-01 12:32:47.084140034 +0200
@@ -222,10 +222,8 @@
 maybe-uninstall-headers: uninstall-headers
 
 install-static: installdirs $(STATIC_LIBS) install-headers install-doc install-examples
-	-$(MV) $(DESTDIR)$(libdir)/libreadline.a $(DESTDIR)$(libdir)/libreadline.old
 	$(INSTALL_DATA) libreadline.a $(DESTDIR)$(libdir)/libreadline.a
 	-test -n "$(RANLIB)" && $(RANLIB) $(DESTDIR)$(libdir)/libreadline.a
-	-$(MV) $(DESTDIR)$(libdir)/libhistory.a $(DESTDIR)$(libdir)/libhistory.old
 	$(INSTALL_DATA) libhistory.a $(DESTDIR)$(libdir)/libhistory.a
 	-test -n "$(RANLIB)" && $(RANLIB) $(DESTDIR)$(libdir)/libhistory.a
 
diff -ruN readline-6.1-orig/support/shlib-install readline-6.1/support/shlib-install
--- readline-6.1-orig/support/shlib-install	2009-10-28 14:30:18.000000000 +0100
+++ readline-6.1/support/shlib-install	2010-09-01 12:34:40.772101116 +0200
@@ -44,16 +44,7 @@
 OLDSUFF=old
 MV=mv
 RM="rm -f"
-LN="ln -s"
-
-# pre-install
-
-if [ -z "$uninstall" ]; then
-	${echo} $RM ${INSTALLDIR}/${LIBNAME}.${OLDSUFF}
-	if [ -f "$INSTALLDIR/$LIBNAME" ]; then
-		${echo} $MV $INSTALLDIR/$LIBNAME ${INSTALLDIR}/${LIBNAME}.${OLDSUFF}
-	fi
-fi
+LN="ln -sf"
 
 # install/uninstall
 
@@ -119,13 +110,11 @@
 case "$host_os-$host_vendor" in
 *linux*|freebsd*-gentoo)
 	# libname.so.M -> libname.so.M.N
-	${echo} ${RM} ${INSTALLDIR}/$LINK2
 	if [ -z "$uninstall" ]; then
 		eval $INSTALL_LINK2
 	fi
 
 	# libname.so -> libname.so.M
-	${echo} ${RM} ${INSTALLDIR}/$LINK1
 	if [ -z "$uninstall" ]; then
 		${echo} cd $INSTALLDIR && ${echo} ${LN} $LINK2 $LINK1
 	fi
