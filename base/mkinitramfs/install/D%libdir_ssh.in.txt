#!/bin/sh
# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
#
# Filename: package/.../mkinitramfs/install/D%libdir_ssh.in.txt
# Copyright (C) 2008 The OpenSDE Project
#
# More information can be found in the files COPYING and README.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

openssh_hostkey() {
	case "$1" in
		rsa|dsa)
			echo "/etc/ssh/ssh_host_${1}_key"
			;;
	esac
}

openssh_has_hostkey() {
	local key=$(openssh_hostkey "$1")

	[ -n "$key" -a -s "$root$key" ]
}

openssh_install_hostkey() {
	local key=$(openssh_hostkey "$1")
	if [ -n "$key" -a -s "$root$key" ]; then
		echo "Injecting OpenSSH Host Key ($1)..."
		cp -vf "$root$key" "$tmpdir$key"
	else
		false
	fi
}

openssh_install_authorized_keys() {
	local ak="/root/.ssh/authorized_keys"
	if [ -s "$root$ak" ]; then
		echo "Injecting root's ssh Authorized Keys"
		cp -v "$root$ak" "$tmpdir$ak"
	fi
}
